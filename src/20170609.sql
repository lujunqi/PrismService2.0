-- MySQL dump 10.13  Distrib 5.6.24, for Win32 (x86)
--
-- Host: 127.0.0.1    Database: prism
-- ------------------------------------------------------
-- Server version	5.1.73-community

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `family_tree`
--

DROP TABLE IF EXISTS `family_tree`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `family_tree` (
  `ft_id` int(11) NOT NULL AUTO_INCREMENT,
  `sup_ft_id` int(11) DEFAULT NULL,
  `ft_name` varchar(255) DEFAULT NULL,
  `ft_icon` varchar(255) DEFAULT NULL COMMENT '头像',
  `ft_tel` varchar(255) DEFAULT NULL COMMENT '联系电话',
  `ft_nick` varchar(255) DEFAULT NULL COMMENT '昵称',
  `ft_sex` int(1) DEFAULT '1' COMMENT '1男2女',
  `ft_order` int(11) DEFAULT '1' COMMENT '排序',
  `ft_spouse` varchar(2000) DEFAULT NULL,
  PRIMARY KEY (`ft_id`)
) ENGINE=InnoDB AUTO_INCREMENT=42 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `family_tree`
--

LOCK TABLES `family_tree` WRITE;
/*!40000 ALTER TABLE `family_tree` DISABLE KEYS */;
INSERT INTO `family_tree` VALUES (1,0,'邹克荣',NULL,NULL,'',1,1,NULL),(2,1,'邹兆成',NULL,NULL,NULL,1,1,NULL),(3,1,'邹兆长',NULL,NULL,NULL,1,2,NULL),(4,1,'邹菊容',NULL,NULL,NULL,2,3,NULL),(5,1,'邹兰容',NULL,NULL,NULL,2,4,NULL),(6,1,'邹荷容',NULL,NULL,NULL,2,5,NULL),(7,2,'邹凤杰',NULL,NULL,NULL,2,1,NULL),(8,2,'邹凤英',NULL,NULL,NULL,2,2,NULL),(9,2,'邹凤芹',NULL,NULL,NULL,2,3,NULL),(10,2,'邹文涛',NULL,NULL,NULL,1,4,NULL),(11,2,'邹鹏程',NULL,NULL,NULL,1,5,NULL),(12,2,'邹凤兰',NULL,NULL,NULL,2,6,NULL),(13,2,'邹鹏翔',NULL,NULL,NULL,1,7,NULL),(14,7,'赵晓东',NULL,NULL,NULL,1,1,NULL),(15,8,'张俊男',NULL,NULL,NULL,1,1,NULL),(16,9,'闫明明',NULL,NULL,NULL,1,1,NULL),(17,10,'邹思琪',NULL,NULL,NULL,2,1,NULL),(18,11,'邹思雨',NULL,NULL,NULL,2,1,NULL),(19,12,'王世曦',NULL,NULL,NULL,2,1,NULL),(20,13,'邹昌序',NULL,NULL,NULL,1,1,NULL),(21,3,'邹冠群',NULL,NULL,NULL,1,1,NULL),(22,3,'邹旭红',NULL,NULL,NULL,1,2,NULL),(23,3,'邹丽霞',NULL,NULL,NULL,2,3,NULL),(24,4,'谭苏娥',NULL,NULL,NULL,2,1,NULL),(25,4,'谭绍辉',NULL,NULL,NULL,1,2,NULL),(26,4,'谭联娥',NULL,'15575871106',NULL,2,3,NULL),(27,4,'谭绍煌',NULL,NULL,NULL,1,4,NULL),(28,4,'谭绍胜',NULL,NULL,NULL,1,5,NULL),(29,4,'谭绍利',NULL,NULL,NULL,1,6,NULL),(30,4,'谭华娥',NULL,NULL,NULL,2,7,NULL),(31,5,'杨锦辉',NULL,NULL,NULL,2,1,NULL),(32,5,'杨锦屏',NULL,NULL,NULL,2,2,NULL),(33,6,'罗忠莲',NULL,NULL,NULL,2,1,NULL),(34,6,'罗爱莲',NULL,NULL,NULL,2,2,NULL),(35,6,'罗志新',NULL,NULL,NULL,1,3,NULL),(36,6,'罗志林',NULL,NULL,NULL,1,4,NULL),(37,26,'卢俊奇',NULL,'13974909197',NULL,1,1,'傅晓昔/13574847631'),(38,26,'卢俊鹏',NULL,'18674822520',NULL,1,1,'王丹'),(39,37,'卢婵儿',NULL,NULL,NULL,2,1,NULL),(40,38,'卢文清',NULL,NULL,NULL,2,1,NULL),(41,25,'谭显益',NULL,NULL,NULL,1,1,NULL);
/*!40000 ALTER TABLE `family_tree` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_cust_class`
--

DROP TABLE IF EXISTS `lb_cust_class`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_cust_class` (
  `cust_class_id` int(11) NOT NULL AUTO_INCREMENT,
  `cust_class_name` varchar(255) DEFAULT NULL,
  `cust_class_order` int(255) DEFAULT NULL,
  PRIMARY KEY (`cust_class_id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_cust_class`
--

LOCK TABLES `lb_cust_class` WRITE;
/*!40000 ALTER TABLE `lb_cust_class` DISABLE KEYS */;
INSERT INTO `lb_cust_class` VALUES (0,'其他',0),(1,'办公',1),(2,'门面',2),(3,'餐饮',3),(4,'娱乐',4),(5,'厂房',5),(6,'家居',6),(7,'酒店',7);
/*!40000 ALTER TABLE `lb_cust_class` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_cust_info`
--

DROP TABLE IF EXISTS `lb_cust_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_cust_info` (
  `cust_id` int(11) NOT NULL AUTO_INCREMENT,
  `cust_name` varchar(255) NOT NULL,
  `gather_id` int(255) NOT NULL COMMENT '创建人',
  `cust_tel` varchar(255) DEFAULT NULL,
  `cust_status` varchar(255) DEFAULT 'FOLLOW' COMMENT 'follow 跟进 measuring 量房未审批 measure 量房  sign 签单 delete 删除',
  `cust_version_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `cust_measure` varchar(10) DEFAULT 'N' COMMENT 'N 未给信息费 Y 已给信息费',
  `cust_create_date` datetime DEFAULT NULL,
  `cust_sex` varchar(255) DEFAULT NULL,
  `cust_memo` varchar(255) DEFAULT NULL COMMENT '备注',
  `cust_class_id` int(11) NOT NULL DEFAULT '0' COMMENT '分类',
  `cust_class_info` varchar(255) DEFAULT NULL COMMENT '分类明细',
  `cust_area` varchar(255) DEFAULT NULL COMMENT '场地面积',
  `cust_address` varchar(255) DEFAULT NULL COMMENT '项目地址',
  `cust_space` varchar(255) DEFAULT NULL COMMENT '场地面积',
  PRIMARY KEY (`cust_id`),
  KEY `fk_cust2gather` (`gather_id`),
  CONSTRAINT `fk_cust2gather` FOREIGN KEY (`gather_id`) REFERENCES `lb_gather` (`gather_id`)
) ENGINE=InnoDB AUTO_INCREMENT=87 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_cust_info`
--

LOCK TABLES `lb_cust_info` WRITE;
/*!40000 ALTER TABLE `lb_cust_info` DISABLE KEYS */;
INSERT INTO `lb_cust_info` VALUES (46,'极限001',23,'13507310021','MEASURE','2017-05-10 07:25:32','N','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(47,'11',24,'13547485654','FOLLOW','2017-05-10 08:29:07','N','2017-05-10 16:29:07','男',NULL,0,NULL,NULL,NULL,NULL),(48,'124',27,'12345678909','FOLLOW','2017-05-10 08:51:26','N','2017-05-10 16:51:26','男',NULL,0,NULL,NULL,NULL,NULL),(49,'124',27,'12345678909','FOLLOW','2017-05-10 08:51:27','N','2017-05-10 16:51:27','男',NULL,0,NULL,NULL,NULL,NULL),(50,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男',NULL,0,NULL,NULL,NULL,NULL),(51,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(52,'蒋委员',26,'13711011011','FOLLOW','2017-05-11 07:18:44','N','2017-05-11 15:18:44','男',NULL,1,'分','湖南省-长沙市-浏阳市','份饭','23'),(53,'11',24,'13547485654','FOLLOW','2017-05-10 08:29:07','N','2017-05-10 16:29:07','男','',0,'','','',''),(54,'124',27,'12345678909','MEASURE','2017-05-10 08:51:27','ING','2017-05-10 16:51:27','男','',0,'','','',''),(55,'124',27,'12345678909','SIGN','2017-05-10 08:51:26','Y','2017-05-10 16:51:26','男','',0,'','','',''),(56,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男','',0,'','','',''),(57,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(58,'极限001',23,'13507310021','SIGNING','2017-05-10 07:25:32','Y','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(59,'11',24,'13547485654','SIGN','2017-05-10 08:29:07','Y','2017-05-10 16:29:07','男','',0,'','','',''),(60,'极限003',23,'13507310021','DELETE','2017-05-10 07:25:32','N','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(61,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:26','N','2017-05-10 16:51:26','男','',0,'','','',''),(62,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:27','N','2017-05-10 16:51:27','男','',0,'','','',''),(63,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男','',0,'','','',''),(64,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(65,'蒋委员',28,'13711011011','FOLLOW','2017-05-11 07:18:44','N','2017-05-11 15:18:44','男','',1,'分','湖南省-长沙市-浏阳市','份饭','23'),(66,'11',28,'13547485654','FOLLOW','2017-05-10 08:29:07','N','2017-05-10 16:29:07','男','',0,'','','',''),(67,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:26','N','2017-05-10 16:51:26','男','',0,'','','',''),(68,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:27','N','2017-05-10 16:51:27','男','',0,'','','',''),(69,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男','',0,'','','',''),(70,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(71,'极限001',28,'13507310021','MEASURE','2017-05-10 07:25:32','N','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(72,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(73,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男','',0,'','','',''),(74,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:27','N','2017-05-10 16:51:27','男','',0,'','','',''),(75,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:26','N','2017-05-10 16:51:26','男','',0,'','','',''),(76,'11',28,'13547485654','FOLLOW','2017-05-10 08:29:07','N','2017-05-10 16:29:07','男','',0,'','','',''),(77,'蒋委员',28,'13711011011','FOLLOW','2017-05-11 07:18:44','N','2017-05-11 15:18:44','男','',1,'分','湖南省-长沙市-浏阳市','份饭','23'),(78,'xo',28,'13849654221','FOLLOW','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22'),(79,'ddd',28,'13455566998','MEASURE','2017-05-11 02:25:53','N','2017-05-11 10:25:53','男','',0,'','','',''),(80,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:27','N','2017-05-10 16:51:27','男','',0,'','','',''),(81,'124',28,'12345678909','FOLLOW','2017-05-10 08:51:26','N','2017-05-10 16:51:26','男','',0,'','','',''),(82,'11',28,'13547485654','FOLLOW','2017-05-10 08:29:07','N','2017-05-10 16:29:07','男','',0,'','','',''),(83,'极限001',28,'13507310021','MEASURE','2017-05-10 07:25:32','N','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(84,'极限001',28,'13507310021','MEASURE','2017-05-10 07:25:32','N','2017-05-10 15:25:32','女','等等',1,'软件公司','湖南省-长沙市-天心区','天心003','123'),(85,'xo',28,'13849654221','MEASURE','2017-05-11 03:17:25','N','2017-05-11 11:17:25','男','吾问无为谓无无无',1,'我问问','湖南省-长沙市-宁乡县','少时诵诗书','22');
/*!40000 ALTER TABLE `lb_cust_info` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_dg_cust`
--

DROP TABLE IF EXISTS `lb_dg_cust`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_dg_cust` (
  `dg_id` int(11) NOT NULL,
  `cust_id` int(11) DEFAULT NULL,
  `user_id` int(11) DEFAULT NULL,
  `dg_status` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`dg_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_dg_cust`
--

LOCK TABLES `lb_dg_cust` WRITE;
/*!40000 ALTER TABLE `lb_dg_cust` DISABLE KEYS */;
/*!40000 ALTER TABLE `lb_dg_cust` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_follow`
--

DROP TABLE IF EXISTS `lb_follow`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_follow` (
  `follow_id` int(11) NOT NULL AUTO_INCREMENT,
  `follow_info` varchar(255) DEFAULT NULL,
  `follow_create_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `follow_type` varchar(255) DEFAULT 'gather' COMMENT 'gather 信息员 cust 会员',
  `other_id` int(11) DEFAULT NULL,
  `follow_name` varchar(255) DEFAULT NULL COMMENT '跟进人',
  PRIMARY KEY (`follow_id`),
  KEY `IND_follow` (`other_id`)
) ENGINE=InnoDB AUTO_INCREMENT=227 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_follow`
--

LOCK TABLES `lb_follow` WRITE;
/*!40000 ALTER TABLE `lb_follow` DISABLE KEYS */;
INSERT INTO `lb_follow` VALUES (150,'咕咕咕咕','2017-05-11 08:16:10','gather',30,'卢俊奇'),(151,'反反复复凤飞飞付付付','2017-05-11 08:16:15','gather',30,'卢俊奇'),(152,'反反复复凤飞飞付付付','2017-05-11 08:16:15','gather',30,'卢俊奇'),(153,'咕咕咕咕跟果敢','2017-05-11 08:16:26','gather',30,'卢俊奇'),(154,'咕咕咕咕跟果敢','2017-05-11 08:16:26','gather',30,'卢俊奇'),(155,'咕咕咕咕跟果敢','2017-05-11 08:16:26','gather',30,'卢俊奇'),(156,'咕咕咕咕跟果敢','2017-05-11 08:16:26','gather',30,'卢俊奇'),(157,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(158,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(159,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(160,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(161,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(162,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(163,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(164,'咕咕咕咕','2017-05-11 08:16:31','gather',30,'卢俊奇'),(165,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(166,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(167,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(168,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(169,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(170,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(171,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(172,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(173,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(174,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(175,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(176,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(177,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(178,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(179,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(180,'跟果敢','2017-05-11 08:16:35','gather',30,'卢俊奇'),(181,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(182,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(183,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(184,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(185,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(186,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:40','gather',30,'卢俊奇'),(187,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(188,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(189,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(190,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(191,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(192,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(193,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(194,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(195,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(196,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(197,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(198,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(199,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(200,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(201,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(202,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(203,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(204,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(205,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(206,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(207,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(208,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:41','gather',30,'卢俊奇'),(209,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:42','gather',30,'卢俊奇'),(210,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:42','gather',30,'卢俊奇'),(211,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:42','gather',30,'卢俊奇'),(212,'咕咕咕咕跟果敢过过过','2017-05-11 08:16:42','gather',30,'卢俊奇'),(213,'的点点滴滴','2017-05-11 08:20:56','gather',23,'卢俊奇'),(214,'咕咕咕咕','2017-05-11 08:21:42','gather',45,'卢俊奇'),(215,'大的大的','2017-05-11 08:23:10','gather',44,'卢俊奇'),(216,'多大的','2017-05-11 08:23:49','gather',43,'卢俊奇'),(217,'多大的','2017-05-11 08:23:52','gather',43,'卢俊奇'),(218,'大的大的','2017-05-11 08:23:55','gather',43,'卢俊奇'),(219,'嗯嗯','2017-05-11 08:24:18','gather',42,'卢俊奇'),(220,'多大的','2017-05-11 08:24:29','gather',41,'卢俊奇'),(221,'多大的','2017-05-11 08:28:44','gather',39,'卢俊奇'),(222,'是是是','2017-05-11 08:28:57','gather',38,'卢俊奇'),(223,'$that.attr(\"disabled\", true); \n		$that.off(\"click\");\n		setTimeout(function(){\n			$that.removeAttr(\"disabled\");\n		},1000);$that.attr(\"disabled\", true); \n		$that.off(\"click\");\n		setTimeout(function(){\n			$that.removeAttr(\"disabled\");\n		},1000);','2017-05-11 08:29:37','gather',37,'卢俊奇'),(224,'$that.attr(\"disabled\", true); \n		$that.off(\"click\");\n		setTimeout(function(){\n			$that.removeAttr(\"disabled\");\n		},1000);','2017-05-11 08:29:41','gather',37,'卢俊奇'),(225,'先谢谢','2017-05-11 08:33:13','gather',36,'卢俊奇'),(226,'先谢谢','2017-05-11 08:33:17','gather',36,'卢俊奇');
/*!40000 ALTER TABLE `lb_follow` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_gather`
--

DROP TABLE IF EXISTS `lb_gather`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_gather` (
  `gather_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) DEFAULT NULL,
  `gather_name` varchar(255) NOT NULL,
  `gather_co` varchar(255) DEFAULT NULL,
  `gather_tel` varchar(255) DEFAULT NULL,
  `gather_type` varchar(255) DEFAULT NULL,
  `gather_level` varchar(255) DEFAULT NULL,
  `gather_status` varchar(10) DEFAULT 'Y' COMMENT 'Y生效 N删除',
  `gather_create_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `gather_weixin` varchar(255) DEFAULT NULL,
  `gather_weixin_jion` varchar(255) DEFAULT 'N' COMMENT '是否加入微信',
  `gather_area` varchar(255) DEFAULT NULL COMMENT '所在地区',
  `gather_card` varchar(255) DEFAULT NULL COMMENT '名片信息',
  `gather_address` varchar(255) DEFAULT NULL COMMENT '详细地址',
  PRIMARY KEY (`gather_id`)
) ENGINE=InnoDB AUTO_INCREMENT=50 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_gather`
--

LOCK TABLES `lb_gather` WRITE;
/*!40000 ALTER TABLE `lb_gather` DISABLE KEYS */;
INSERT INTO `lb_gather` VALUES (23,1,'信息员001','保利花园','13707312221','中介','月亮','Y','2017-05-10 07:23:39','weixin01','Y','湖南省-长沙市-天心区','upload/2.jpg','天心阁'),(24,1,'多大的24','是是是','13754569852','中介','月亮','Y','2017-06-05 09:58:01','等等','Y','湖南省-长沙市-长沙县','upload/1.png','搜索'),(25,1,'111',NULL,'13475321542','其他','星星','Y','2017-05-10 08:29:24',NULL,'N',NULL,NULL,NULL),(26,1,'烦烦烦','11','15788559966','其他','星星','Y','2017-05-10 08:29:55',NULL,'N',NULL,NULL,NULL),(27,1,'22',NULL,'12455559998','其他','星星','Y','2017-05-10 08:37:20',NULL,'N',NULL,NULL,NULL),(28,12,'是是是','是是是','12355446699','其他','星星','Y','2017-05-11 02:25:11',NULL,'N','湖南省-长沙市-天心区','upload/e5a82de2a73099f474f3b79297702f9c.png',NULL),(29,1,'信息员001','保利花园','13707312221','中介','月亮','Y','2017-05-10 07:23:39','weixin01','Y','湖南省-长沙市-天心区','upload/2.jpg','天心阁'),(30,1,'多大的','是是是','13754569852','中介','月亮','Y','2017-05-10 08:24:38','等等','Y','湖南省-长沙市-长沙县','upload/1.png','搜索'),(31,1,'111','','13475321542','其他','星星','Y','2017-05-10 08:29:24','','N','','',''),(32,1,'烦烦烦','11','15788559966','其他','星星','Y','2017-05-10 08:29:55','','N','','',''),(33,1,'22','','12455559998','其他','星星','Y','2017-05-10 08:37:20','','N','','',''),(34,12,'是是是','是是是','12355446699','其他','星星','Y','2017-05-11 02:25:11','','N','湖南省-长沙市-天心区','upload/e5a82de2a73099f474f3b79297702f9c.png',''),(35,1,'信息员001','保利花园','13707312221','中介','月亮','Y','2017-05-10 07:23:39','weixin01','Y','湖南省-长沙市-天心区','upload/2.jpg','天心阁'),(36,1,'多大的','是是是','13754569852','中介','月亮','Y','2017-05-10 08:24:38','等等','Y','湖南省-长沙市-长沙县','upload/1.png','搜索'),(37,1,'111','','13475321542','其他','星星','Y','2017-05-10 08:29:24','','N','','',''),(38,1,'烦烦烦','11','15788559966','其他','星星','Y','2017-05-10 08:29:55','','N','','',''),(39,1,'22','','12455559998','其他','星星','Y','2017-05-10 08:37:20','','N','','',''),(40,12,'是是是','是是是','12355446699','其他','星星','Y','2017-05-11 02:25:11','','N','湖南省-长沙市-天心区','upload/e5a82de2a73099f474f3b79297702f9c.png',''),(41,1,'信息员001','保利花园','13707312221','中介','月亮','Y','2017-05-10 07:23:39','weixin01','Y','湖南省-长沙市-天心区','upload/2.jpg','天心阁'),(42,1,'多大的','是是是','13754569852','中介','月亮','Y','2017-05-10 08:24:38','等等','Y','湖南省-长沙市-长沙县','upload/1.png','搜索'),(43,1,'111','','13475321542','其他','星星','Y','2017-05-10 08:29:24','','N','','',''),(44,1,'烦烦烦','11','15788559966','其他','星星','Y','2017-05-10 08:29:55','','N','','',''),(45,1,'22','','12455559998','其他','星星','Y','2017-05-10 08:37:20','','N','','',''),(46,12,'是是是','是是是','12355446699','其他','星星','Y','2017-05-11 02:25:11','','N','湖南省-长沙市-天心区','upload/e5a82de2a73099f474f3b79297702f9c.png',''),(47,12,'等等','等等','12343212345','其他','星星','Y','2017-05-12 06:47:42','等等','N','湖南省-长沙市-天心区','upload/9288848563fb27b9c75bf0a05a68f699.jpg','带点吃的'),(48,1,'ss','ss','12546587494','其他','星星','Y','2017-05-17 02:28:04',NULL,'N',NULL,'upload/4c509767f5c63fe4e20d4e749088d2f0.jpg',NULL),(49,10,'ccc','cc','12457896541','其他','星星','Y','2017-05-31 02:55:31',NULL,'N','湖南省-长沙市-岳麓区',NULL,'ddd');
/*!40000 ALTER TABLE `lb_gather` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_menu_tree`
--

DROP TABLE IF EXISTS `lb_menu_tree`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_menu_tree` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL,
  `url` varchar(255) DEFAULT NULL,
  `op` int(255) DEFAULT NULL,
  `menu_status` varchar(255) DEFAULT 'Y',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_menu_tree`
--

LOCK TABLES `lb_menu_tree` WRITE;
/*!40000 ALTER TABLE `lb_menu_tree` DISABLE KEYS */;
INSERT INTO `lb_menu_tree` VALUES (1,0,'业务管理',NULL,2,'Y'),(2,0,'系统管理',NULL,5,'Y'),(3,1,'信息员管理','pa/lb_gathers.v',2,'Y'),(4,1,'客户管理','pa/lb_cust_infos.v',2,'Y'),(5,2,'用户管理','pa/lb_user.v',5,'Y'),(6,0,'设计管理',NULL,3,'Y'),(7,6,'我的客户','pa/lb_my_cust_infos.v',3,'Y'),(8,0,'帮助中心',NULL,0,'Y'),(9,8,'欢迎使用','welcome.html',0,'Y'),(10,1,'量房客户','pa/lb_cust_infos.v?cust_status=MEASURE',2,'Y'),(13,1,'客户审批','pa/lb_cust_measure_check.v',3,'Y');
/*!40000 ALTER TABLE `lb_menu_tree` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_user`
--

DROP TABLE IF EXISTS `lb_user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_user` (
  `user_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_name` varchar(255) DEFAULT NULL,
  `user_tel` varchar(255) DEFAULT NULL,
  `user_acc` varchar(255) DEFAULT NULL,
  `user_pwd` varchar(255) DEFAULT NULL,
  `user_status` varchar(10) DEFAULT 'Y',
  `user_opt` int(20) DEFAULT '2' COMMENT '1系统管理员 2 员工 3 设计师 9 主管',
  PRIMARY KEY (`user_id`)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_user`
--

LOCK TABLES `lb_user` WRITE;
/*!40000 ALTER TABLE `lb_user` DISABLE KEYS */;
INSERT INTO `lb_user` VALUES (1,'卢俊奇','139749190971','ljq','ljq','y',1),(2,'柳斌','13907310001','lb','lb','y',3),(10,'罗欣','13974909197','lx','lx','y',2),(12,'liubo_333','liubo_333','liubo_333','123456','N',2);
/*!40000 ALTER TABLE `lb_user` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `lb_user_acc_sm`
--

DROP TABLE IF EXISTS `lb_user_acc_sm`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `lb_user_acc_sm` (
  `user_m_id` int(255) DEFAULT NULL COMMENT '主账号',
  `user_s_id` int(255) DEFAULT NULL COMMENT '从账号'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `lb_user_acc_sm`
--

LOCK TABLES `lb_user_acc_sm` WRITE;
/*!40000 ALTER TABLE `lb_user_acc_sm` DISABLE KEYS */;
INSERT INTO `lb_user_acc_sm` VALUES (12,10),(12,2),(12,1),(2,12),(2,10),(2,1),(10,12),(10,2),(10,1);
/*!40000 ALTER TABLE `lb_user_acc_sm` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `sm_bean`
--

DROP TABLE IF EXISTS `sm_bean`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `sm_bean` (
  `ACTION` varchar(200) NOT NULL,
  `KEY` varchar(200) NOT NULL,
  `VAL` text,
  PRIMARY KEY (`ACTION`,`KEY`),
  KEY `IDX_BEAN_ACTION` (`ACTION`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `sm_bean`
--

LOCK TABLES `sm_bean` WRITE;
/*!40000 ALTER TABLE `sm_bean` DISABLE KEYS */;
INSERT INTO `sm_bean` VALUES ('bean','SQL','SELECT * FROM SM_BEAN'),('lb_cust_info','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nSELECT\n	c.*,\n	\n	getTel(${session.get(\'user_opt\')<INT>},${session.get(\'user_id\')<INT>},g.user_id,c.cust_tel) as cust_tel,\n	c2.cust_class_name\nFROM\n	v_lb_cust_info c,lb_cust_class c2,v_lb_gather g\nwhere c.cust_class_id = c2.cust_class_id\n and g.gather_id = c.gather_id\n  and c.cust_id = ${cust_id<INT>}\n]]>\n</bean>\n\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../lb/model_form_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n/*\n#set($col={});\n#set($btn={});\n\n$col.put(\"客户名称\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_name\",\"VAL\":\"map.cust_name\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n$col.put(\"客户电话\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_tel\",\"VAL\":\"map.cust_tel\",\"OTHER\":{\"p_verify\":\"ctel\"}});\n$col.put(\"性别\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_sex\",\"VAL\":\"map.cust_sex\"});\n$col.put(\"所属区域\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_area\",\"VAL\":\"map.cust_area\"});\n\n$col.put(\"详细地址\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_address\",\"VAL\":\"map.cust_address\"});\n$col.put(\"场地面积\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_space\",\"VAL\":\"map.cust_space\",\"AUX\":\"平米\"});\n$col.put(\"项目分类\",{\"TYPE\":\"TEXT\",\"KEY\":\"cust_class_name\",\"VAL\":\"map.cust_class_name\"});\n\n$col.put(\"项目性质\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_class_info\",\"VAL\":\"map.cust_class_info\"});\n\n$col.put(\"备注\",{\"TYPE\":\"TEXTAREA\", \"KEY\":\"cust_memo\",\"VAL\":\"map.cust_memo\"});\n\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"客户资料\"); \n\n#set($follow={});\n$follow.put(\"ID\",\"map.follow_id\");\n$follow.put(\"时间\",\"map.follow_create_date\");\n$follow.put(\"跟进人\",\"map.follow_name\");\n$follow.put(\"信息\",\"map.follow_info\");\n$Req.setAttribute(\"FOLLOW\",$follow);\n*/\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n$(\"#followbtn\").off(\"click\");\n$(\"#followbtn\").click(function(){\n	var param = {};\n	param[\"follow_info\"] = $(\"#follow_info\").val(); \n	$.extend(param,req[\"param\"]);\n	if(param[\"follow_info\"]==\"\"){\n		layer.msg(\"填写跟进信息\");\n		return;\n	}\n	var $that = $(this);\n	$that.attr(\"disabled\", true); \n	setTimeout(function(){\n		$that.removeAttr(\"disabled\");\n	},1000);\n	$.post(\"pa/lb_follow_add.u\",param,function(){\n		$that.removeAttr(\"disabled\");\n		$(\"#follow_info\").val(\"\");\n		callBack(req);\n		top.frames[\'main\'].init();\n	});\n});\n]]>\n</bean>\n<bean name=\"CAPTION\">\n<![CDATA[\n<form class=\"layui-form\" onsubmit=\"return false;\" action=\"\">\n  <div class=\"layui-form-item layui-form-text\">\n      <textarea name=\"desc\" placeholder=\"请输入内容\" id=\"follow_info\" class=\"layui-textarea\"></textarea>\n  </div>\n  <div class=\"layui-form-item layui-form-text\">\n		<button class=\"layui-btn\" id=\"followbtn\" lay-submit lay-filter=\"formDemo\">立即提交</button>\n  </div>\n</form>\n]]>\n</bean>\n</xml>\n'),('lb_cust_infos','XML','<xml>\n<bean name=\"DSQL\">\n<![CDATA[\nSELECT\n	c.cust_id,\n	u.user_id,\n	c.cust_name,\n	getTel(${v.set(\"session.get(\'user_opt\')\",\"INT\")},${v.set(\"session.get(\'user_id\')\",\"INT\")},u.user_id,c.cust_tel) as cust_tel,\n	CASE\nWHEN c.cust_measure = \'N\' THEN\n	\'未支付\'\nWHEN c.cust_measure = \'Y\' THEN\n	\'支付\'\nWHEN c.cust_measure = \'ING\' THEN\n	\'支付待审\'\nELSE\n	\'未知\'\nEND AS cust_measure_pay,\n CASE\nWHEN c.cust_status = \'FOLLOW\' THEN\n	\'跟进\'\nWHEN c.cust_status = \'SIGN\' THEN\n	\'签单\'\nWHEN c.cust_status = \'SIGNING\' THEN\n	\'签单待审\'\nWHEN c.cust_status = \'MEASURE\' THEN\n	\'量房\'\nWHEN c.cust_status = \'MEASURING\' THEN\n	\'量房待审\'\nWHEN c.cust_status = \'DELETE\' THEN\n	\'删除\'\nELSE\n	\'未知\'\nEND AS cust_status_e,\n c.cust_measure,\n g.gather_name,\n c.cust_status,\n DATE_FORMAT(c.cust_create_date,\'%Y-%m-%d %H时\') cust_create_date,\n u.user_name,\n (\n	SELECT\n		count(1)\n	FROM\n		lb_follow f\n	WHERE\n		f.other_id = c.cust_id\n	AND f.follow_type = \'cust\'\n) follow_num,\n datediff(\n	NOW(),\n	(\n		SELECT\n			max(f.follow_create_date)\n		FROM\n			lb_follow f\n		WHERE\n			f.other_id = c.cust_id\n		AND f.follow_type = \'cust\'\n	)\n) follow_day\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND	(u.user_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")}))\nAND u.user_id = g.user_id\n\n#if ($v.equals(\"cust_status\",\"MEASURE\"))\n and c.cust_status in(\'MEASURE\',\'SIGN\')\n#end\n#if ($v.equals(\"cust_status\",\"MEASURE_PAY_NUM\"))\n and c.cust_measure=\'Y\' and c.cust_status in(\'MEASURE\',\'SIGN\')\n#end\n#if ($v.equals(\"cust_status\",\"SIGN_NUM\"))\n and c.cust_measure=\'Y\' and c.cust_status in(\'SIGN\')\n#end\n\n\n\n#if (! $v.isEmpty(\"cust_name\"))\n and c.cust_name like  CONCAT(\'%\', ${v.set(\"cust_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"cust_tel\"))\n and c.cust_tel like  CONCAT(\'%\', ${v.set(\"cust_tel\",\"STRING\")},\'%\')\n#end\n\n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n#if (! $v.equals(\"cust_id\",\"ALL\") && ! $v.isEmpty(\"cust_id\"))\n and c.cust_id = ${v.set(\"cust_id\",\"INT\")}\n#end\n\nORDER BY\n	follow_day asc,cust_id desc\n#if (! $v.isEmpty(\"_page\"))\nlimit ${v.set(\"_page\",\"INT\")},${v.set(\"_offset\",\"INT\")}\n#end\n]]>\n\n</bean>\n\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n<bean name=\"TOTAL\" value=\"pa/lb_cust_infos_total.s\" />\n<bean name=\"my_user\">\n<![CDATA[\nselect user_id K,user_name V from lb_user u\nwhere u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>} )\n]]></bean>\n<bean name=\"gathers\">\n<![CDATA[\nselect gather_id as K,gather_name AS V from v_lb_gather where user_id = ${session.get(\'user_id\')<INT>}\n]]></bean>\n<bean name=\"my_cust\">\n<![CDATA[\nselect c.cust_id K,c.cust_name V\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND	(u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>}))\nAND u.user_id = g.user_id\n]]></bean>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n#set($colgroup=[50]);\n$col.put(\"ID\",\"map.cust_id\");\n$col.put(\"客户名称\",\"cust_name:map\");\n$col.put(\"隶属人\",\"map.user_name\");\n$col.put(\"信息员\",\"map.gather_name\");\n\n$col.put(\"电话\",\"map.cust_tel\");\n$col.put(\"创建时间\",\"map.cust_create_date\");\n\n$col.put(\"信息费\",\"map.cust_measure_pay\");\n$col.put(\"状态\",\"map.cust_status_e\");\n$col.put(\"回访次数\",\"follow:map\");\n$col.put(\"未回访天数\",\"map.follow_day\");\n$col.put(\"操作\",\"opt:map\");\n\n$Req.setAttribute(\"colgroup\",$colgroup);\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"客户管理\"); \n$Req.setAttribute(\"DATAURL\",\"pa/lb_cust_infos.s\");\n$btn.put(\"新增\",\"add({\'win\':\'pa/lb_cust_info_upt.v\',\'add\':\'pa/lb_cust_info_add.u\'})\");\n$Req.setAttribute(\"BUTTON\",$btn);\n\n#set($search={}); \n$search.put(\"编码\",{\"TYPE\":\"TEXT\",\"KEY\":\"cust_id\",\"OTHER\":{\"onkeyup\":\"this.value=this.value.replace(/\\D/g,\'\')\", \"onafterpaste\":\"this.value=this.value.replace(/\\D/g,\'\')\"}});\n$search.put(\"姓名\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_name\"});\n$search.put(\"手机\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_tel\"});\n$search.put(\"信息员\",{\"TYPE\":\"SELECT\",\"KEY\":\"gather_id\",\"SQL\":\"gathers\",\"ISNULL\":\"ALL\"});\n$search.put(\"隶属人\",{\"TYPE\":\"SELECT\",\"KEY\":\"user_id\",\"SQL\":\"my_user\",\"ISNULL\":\"ALL\"});\n$Req.setAttribute(\"SEARCH\",$search);\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n\n\ncmd.data(\"follow\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.html(v.follow_num+\"次\");\n	a.click(function(){\n		var req = {};\n		req[\"param\"] = {other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_follow.v\";\n		req[\"info\"]=\"pa/lb_follow.s\";\n		\n		win(req);\n	});\n	o.append(a);\n	if(v.follow_day>10){\n		a.attr(\"style\",\"color:red\");\n	}\n});\ncmd.data(\"cust_name\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<a href=\"javascript:\">\'+v.cust_name+\'</a>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {cust_id:v.cust_id,other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_cust_info.v\";\n		req[\"info\"]=\"pa/lb_cust_info.s\";\n		req[\"follow\"]=\"pa/lb_follow.s\";\n		info(req);\n	});\n	o.append(span);\n});\ncmd.data(\"opt\",function(o,v){\n	\n	\n	\n	var del = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[删除]</span>\')\n	del.click(function(){\n		layer.confirm(\'是否要删除？\', {\n		  btn: [\'确认\',\'取消\'] \n		}, function(){\n		   $.get(\"pa/lb_cust_info_del.u\",{cust_id:v.cust_id},function(){\n			   init();\n			   layer.closeAll();\n		   });\n		}, function(){\n		   layer.closeAll();\n		});\n	\n	});\n	if(v.user_id == my_user_id){\n		o.append(del);\n	}\n	\n	//跟进\n	var cust_status = v.cust_status;\n	\n	if(cust_status==\"FOLLOW\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[量房]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要量房？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_measure.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($status);\n		}\n	};\n	if(cust_status==\"MEASURE\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[签单]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要签单？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_sign.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($status);\n		}\n	};\n	if((cust_status==\"MEASURE\" || cust_status==\"SIGN\") && v.cust_measure ==\"N\"){\n		var $pay = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[信息费]</span>\');\n		$pay.click(function(){\n			layer.confirm(\'是否支付信息费？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_pay.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($pay);\n		}\n	};\n	 \n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_cust_infos_total','DSQL','SELECT\n	count(1) as total\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND	(u.user_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")}))\nAND u.user_id = g.user_id\n\n#if ($v.equals(\"cust_status\",\"MEASURE\"))\n and c.cust_status in(\'MEASURE\',\'SIGN\')\n#end\n#if ($v.equals(\"cust_status\",\"MEASURE_PAY_NUM\"))\n and c.cust_measure=\'Y\' and c.cust_status in(\'MEASURE\',\'SIGN\')\n#end\n#if ($v.equals(\"cust_status\",\"SIGN_NUM\"))\n and c.cust_measure=\'Y\' and c.cust_status in(\'SIGN\')\n#end\n\n#if (! $v.isEmpty(\"cust_name\"))\n and c.cust_name like  CONCAT(\'%\', ${v.set(\"cust_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"cust_tel\"))\n and c.cust_tel like  CONCAT(\'%\', ${v.set(\"cust_tel\",\"STRING\")},\'%\')\n#end\n\n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n#if (! $v.equals(\"cust_id\",\"ALL\") && ! $v.isEmpty(\"cust_id\"))\n and c.cust_id = ${v.set(\"cust_id\",\"INT\")}\n#end\n'),('lb_cust_info_add','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nINSERT INTO lb_cust_info (\n	cust_name,\n	gather_id,\n	cust_tel,\n	cust_sex,\n	cust_memo,\n	cust_class_id,\n	cust_class_info,\n	cust_area,\n	cust_address,\n	cust_space,\n	cust_create_date\n)\nVALUES\n(\n${cust_name<STRING>},\n${gather_id<STRING>},\n${cust_tel<STRING>},\n${cust_sex<STRING>},\n${cust_memo<STRING>},\n${cust_class_id<STRING>},\n${cust_class_info<STRING>},\n${cust_area<STRING>},\n${cust_address<STRING>},\n${cust_space<STRING>},\nnow()\n)\n\n]]>\n</bean>\n\n</xml>\n'),('lb_cust_info_del','SQL','UPDATE LB_CUST_INFO SET CUST_STATUS = \'DELETE\' WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_follow','SQL','UPDATE LB_CUST_INFO SET CUST_STATUS = \'DELETE\' WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_measure','SQL','UPDATE LB_CUST_INFO SET CUST_STATUS = \'MEASURING\' WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_pay','SQL','UPDATE LB_CUST_INFO SET cust_measure = \'ING\' WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_pay_check','SQL','UPDATE LB_CUST_INFO SET cust_measure = ${cust_measure<STRING>} WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_sign','SQL','UPDATE LB_CUST_INFO SET CUST_STATUS = \'SIGNING\' WHERE CUST_ID = ${cust_id<STRING>}\n'),('lb_cust_info_status','SQL','UPDATE LB_CUST_INFO SET CUST_STATUS = ${cust_status<STRING>} WHERE CUST_ID = ${cust_id<INT>}\n'),('lb_cust_info_upt','XML','<xml>\n\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_form_templete.jsp\"/>\n<bean name=\"gathers\">\n<![CDATA[\nselect gather_id as K,gather_name AS V from v_lb_gather where user_id = ${session.get(\'user_id\')<INT>}\n]]></bean>\n<bean name=\"cust_classes\">\n<![CDATA[\nselect cust_class_id as K,cust_class_name AS V from lb_cust_class order by cust_class_order\n]]></bean>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n$col.put(\"客户名称\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_name\",\"VAL\":\"map.cust_name\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n$col.put(\"客户电话\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_tel\",\"VAL\":\"map.cust_tel\",\"OTHER\":{\"p_verify\":\"ctel\"}});\n$col.put(\"性别\",{\"TYPE\":\"RADIO\", \"KEY\":\"cust_sex\",\"VAL\":\"map.cust_sex\",\"LIST\":[{\"K\":\"男\",\"V\":\"男\",\"C\":\"checked\"},{\"K\":\"女\",\"V\":\"女\"}]});\n$col.put(\"所属区域\",{\"TYPE\":\"AREA\", \"KEY\":\"cust_area\",\"VAL\":\"map.cust_area\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n\n$col.put(\"详细地址\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_address\",\"VAL\":\"map.cust_address\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n$col.put(\"场地面积\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_space\",\"VAL\":\"map.cust_space\",\"AUX\":\"平米\"});\n$col.put(\"项目分类\",{\"TYPE\":\"SELECT\",\"KEY\":\"cust_class_id\",\"VAL\":\"map.cust_class_id\",\"SQL\":\"cust_classes\"});\n$col.put(\"项目性质\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_class_info\",\"VAL\":\"map.cust_class_info\"});\n$col.put(\"信息员\",{\"TYPE\":\"SELECT\",\"KEY\":\"gather_id\",\"VAL\":\"map.gather_id\",\"SQL\":\"gathers\"});\n$col.put(\"备注\",{\"TYPE\":\"TEXTAREA\", \"KEY\":\"cust_memo\",\"VAL\":\"map.cust_memo\", \"OTHER\":{\"p_verify\":\"noNull\"}});\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"客户管理\"); \n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\nvar form = layui.form();\ntry{\n	$(\"#gather_id\").val(req.param.gather_id);\n}catch(e){}\nform.render();\np_verify[\"ctel\"]=function(o){\n	var v = p_verify.val(o);\n	if(v.length!=11 || p_verify[\"number\"](o)){\n		o.attr(\"v_check\",\"请填写手机号码\");\n	}else{\n		\n		o.attr(\"v_check\",\"手机号码有重复\");\n		p_verify.get(\"pa/lb_tel_only.s\",{tel:o.val()},function(data){\n			if(data.length==0){\n				o.attr(\"v_check\",\"Y\");\n			}\n		},\"json\");\n	}\n};\n]]>\n</bean>\n</xml>\n'),('lb_cust_measure_check','XML','<xml>\n<bean name=\"DSQL\">\n<![CDATA[\nSELECT\n	c.cust_id,\n	u.user_id,\n	c.cust_name,\n	c.cust_tel,\n	CASE\nWHEN c.cust_measure = \'N\' THEN\n	\'未支付\'\nWHEN c.cust_measure = \'Y\' THEN\n	\'支付\'\nWHEN c.cust_measure = \'ING\' THEN\n	\'支付待审\'\nELSE\n	\'未知\'\nEND AS cust_measure_pay,\n CASE\nWHEN c.cust_status = \'FOLLOW\' THEN\n	\'跟进\'\nWHEN c.cust_status = \'SIGN\' THEN\n	\'签单\'\nWHEN c.cust_status = \'SIGNING\' THEN\n	\'签单待审\'\nWHEN c.cust_status = \'MEASURE\' THEN\n	\'量房\'\nWHEN c.cust_status = \'MEASURING\' THEN\n	\'量房待审\'\nWHEN c.cust_status = \'DELETE\' THEN\n	\'删除\'\nELSE\n	\'未知\'\nEND AS cust_status_e,\n c.cust_measure,\n g.gather_name,\n c.cust_status,\n DATE_FORMAT(c.cust_create_date,\'%Y-%m-%d\') cust_create_date,\n u.user_name,\n (\n	SELECT\n		count(1)\n	FROM\n		lb_follow f\n	WHERE\n		f.other_id = c.cust_id\n	AND f.follow_type = \'cust\'\n) follow_num,\n datediff(\n	NOW(),\n	(\n		SELECT\n			max(f.follow_create_date)\n		FROM\n			lb_follow f\n		WHERE\n			f.other_id = c.cust_id\n		AND f.follow_type = \'cust\'\n	)\n) follow_day\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND u.user_id = g.user_id\nAND (c.cust_status IN (\'MEASURING\',\'SIGNING\') OR c.cust_measure = \'ING\')\n\n#if (! $v.isEmpty(\"cust_name\"))\n and c.cust_name like  CONCAT(\'%\', ${v.set(\"cust_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"cust_tel\"))\n and c.cust_tel like  CONCAT(\'%\', ${v.set(\"cust_tel\",\"STRING\")},\'%\')\n#end\n\n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n#if (! $v.equals(\"cust_id\",\"ALL\") && ! $v.isEmpty(\"cust_id\"))\n and c.cust_id = ${v.set(\"cust_id\",\"INT\")}\n#end\n\nORDER BY\n	follow_day asc,cust_id desc\n#if (! $v.isEmpty(\"_page\"))\nlimit ${v.set(\"_page\",\"INT\")},${v.set(\"_offset\",\"INT\")}\n#end\n]]>\n\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n<bean name=\"TOTAL\" value=\"pa/lb_cust_measure_check_total.s\" />\n \n<bean name=\"gathers\">\n<![CDATA[\nselect gather_id as K,gather_name AS V from v_lb_gather where user_id = ${session.get(\'user_id\')<INT>}\n]]></bean>\n<bean name=\"my_user\">\n<![CDATA[\nselect user_id K,user_name V from lb_user u\nwhere u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>} )\n]]></bean>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n#set($colgroup=[50]);\n$col.put(\"ID\",\"map.cust_id\");\n$col.put(\"客户名称\",\"cust_name:map\");\n$col.put(\"隶属人\",\"map.user_name\");\n$col.put(\"信息员\",\"map.gather_name\");\n\n$col.put(\"电话\",\"map.cust_tel\");\n$col.put(\"创建时间\",\"map.cust_create_date\");\n\n$col.put(\"信息费\",\"map.cust_measure_pay\");\n$col.put(\"状态\",\"map.cust_status_e\");\n$col.put(\"回访次数\",\"follow:map\");\n$col.put(\"未回访天数\",\"map.follow_day\");\n$col.put(\"操作\",\"opt:map\");\n\n$Req.setAttribute(\"colgroup\",$colgroup);\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"客户信息审批\"); \n$Req.setAttribute(\"DATAURL\",\"pa/lb_cust_measure_check.s\");\n \n\n#set($search={}); \n$search.put(\"编码\",{\"TYPE\":\"TEXT\",\"KEY\":\"cust_id\",\"OTHER\":{\"onkeyup\":\"this.value=this.value.replace(/\\D/g,\'\')\", \"onafterpaste\":\"this.value=this.value.replace(/\\D/g,\'\')\"}});\n$search.put(\"姓名\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_name\"});\n$search.put(\"手机\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_tel\"});\n$search.put(\"信息员\",{\"TYPE\":\"SELECT\",\"KEY\":\"gather_id\",\"SQL\":\"gathers\",\"ISNULL\":\"ALL\"});\n$search.put(\"隶属人\",{\"TYPE\":\"SELECT\",\"KEY\":\"user_id\",\"SQL\":\"my_user\",\"ISNULL\":\"ALL\"});\n$Req.setAttribute(\"SEARCH\",$search);\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n\n\ncmd.data(\"follow\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.html(v.follow_num+\"次\");\n	a.click(function(){\n		var req = {};\n		req[\"param\"] = {other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_follow.v\";\n		req[\"info\"]=\"pa/lb_follow.s\";\n		\n		win(req);\n	});\n	o.append(a);\n	if(v.follow_day>10){\n		a.attr(\"style\",\"color:red\");\n	}\n});\ncmd.data(\"cust_name\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<a href=\"javascript:\">\'+v.cust_name+\'</a>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {cust_id:v.cust_id,other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_cust_info.v\";\n		req[\"info\"]=\"pa/lb_cust_info.s\";\n		req[\"follow\"]=\"pa/lb_follow.s\";\n		info(req);\n	});\n	o.append(span);\n});\ncmd.data(\"opt\",function(o,v){\n	\n	\n	\n	var check = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[审批]</span>\')\n	check.click(function(){\n		\n		if(v.cust_measure==\"ING\"){//支付待审\n			layer.open({\n				content: \"信息费审批\",\n				btn: [\'通过\',\'驳回\',\'关闭\'],\n				yes: function(index, layero){\n				   $.get(\"pa/lb_cust_info_pay_check.u\",{cust_measure:\"Y\",cust_id:v.cust_id},function(){\n					   init();\n					   layer.closeAll();\n				   });\n				}\n				,btn2: function(index, layero){\n				    $.get(\"pa/lb_cust_info_pay_check.u\",{cust_measure:\"N\",cust_id:v.cust_id},function(){\n					   init();\n					   layer.closeAll();\n				   });\n				   return false;\n				}\n				,btn3: function(index, layero){\n					layer.closeAll();\n					return false;\n				}\n			});\n			 \n		}else{\n			var check = {};\n			check[\"MEASURING\"]={\"INFO\":\"量房审批\",\"YES\":\"MEASURE\",\"NO\":\"FOLLOW\"};\n			check[\"SIGNING\"]={\"INFO\":\"签单审批\",\"YES\":\"SIGN\",\"NO\":\"MEASURE\"};\n			layer.open({\n				content: check[v.cust_status][\"INFO\"],\n				btn: [\'通过\',\'驳回\',\'关闭\'],\n				yes: function(index, layero){\n				   $.get(\"pa/lb_cust_info_status.u\",{cust_status:check[v.cust_status][\"YES\"],cust_id:v.cust_id},function(){\n					   init();\n					   layer.closeAll();\n				   });\n				}\n				,btn2: function(index, layero){\n				   $.get(\"pa/lb_cust_info_status.u\",{cust_status:check[v.cust_status][\"NO\"],cust_id:v.cust_id},function(){\n					   init();\n					   layer.closeAll();\n				   });\n				   return false;\n				}\n				,btn3: function(index, layero){\n					layer.closeAll();\n					return false;\n				}\n			});\n			\n		}\n		\n	});\n	o.append(check);\n	\n	\n	\n	 \n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_cust_measure_check_total','DSQL','SELECT\n	count(1) as total\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND (c.cust_status IN (\'MEASURING\',\'SIGNING\') OR c.cust_measure = \'ING\')\n\nAND u.user_id = g.user_id\n\n#if (! $v.isEmpty(\"cust_name\"))\n and c.cust_name like  CONCAT(\'%\', ${v.set(\"cust_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"cust_tel\"))\n and c.cust_tel like  CONCAT(\'%\', ${v.set(\"cust_tel\",\"STRING\")},\'%\')\n#end\n\n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n#if (! $v.equals(\"cust_id\",\"ALL\") && ! $v.isEmpty(\"cust_id\"))\n and c.cust_id = ${v.set(\"cust_id\",\"INT\")}\n#end\n'),('lb_follow','XML','<xml>\n<bean name=\"DSQL\">\n<![CDATA[\nselect follow_id , date_format(follow_create_date,\'%Y-%m-%d\') follow_create_date,follow_name,\nfollow_info \nfrom lb_follow \nwhere follow_type=${v.set(\"follow_type\",\"STRING\")} and other_id=${v.set(\"other_id\",\"INT\")}\norder by follow_id desc\n#if (! $v.isEmpty(\"_page\"))\nlimit ${v.set(\"_page\",\"INT\")},${v.set(\"_offset\",\"INT\")}\n#end\n]]>\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TOTAL\" value=\"pa/lb_follow_total.s\"/>\n\n<bean name=\"TEMPLATE\" value=\"../page/win_list_templete.jsp\"/>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n#set($col={});\n#set($btn={});\n$col.put(\"ID\",\"map.follow_id\");\n$col.put(\"时间\",\"map.follow_create_date\");\n$col.put(\"跟进人\",\"map.follow_name\");\n\n$col.put(\"信息\",\"map.follow_info\");\n\n\n$Req.setAttribute(\"COL\",$col);\n\n$Req.setAttribute(\"BUTTON\",$btn)\n$Req.setAttribute(\"DATAURL\",\"pa/lb_user.s\");\n$Req.setAttribute(\"VIEWNAME\",\"跟进管理\");\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n	$(\"#followbtn\").on(\"click\",function(){\n		\n		\n		var param = {};\n		param[\"follow_info\"] = $(\"#follow_info\").val(); \n		$.extend(param,req[\"param\"]);\n		if(param[\"follow_info\"]==\"\"){\n			layer.msg(\"填写跟进信息\");\n			return;\n		}\n		var $that = $(this);\n		$that.attr(\"disabled\", true); \n		$that.off(\"click\");\n		setTimeout(function(){\n			$that.removeAttr(\"disabled\");\n		},1000);\n		$.post(\"pa/lb_follow_add.u\",param,function(){\n			$that.removeAttr(\"disabled\");\n			$(\"#follow_info\").val(\"\");\n			callBack(req);\n			top.frames[\'main\'].init();\n			\n		});\n	});\n]]>\n</bean>\n<bean name=\"CAPTION\">\n<![CDATA[\n<form class=\"layui-form\" onsubmit=\"return false;\" action=\"\">\n  <div class=\"layui-form-item layui-form-text\">\n      <textarea name=\"desc\" placeholder=\"请输入内容\" id=\"follow_info\" class=\"layui-textarea\"></textarea>\n  </div>\n  <div class=\"layui-form-item layui-form-text\">\n		<button class=\"layui-btn\" id=\"followbtn\" lay-submit lay-filter=\"formDemo\">立即提交</button>\n  </div>\n</form>\n]]>\n</bean>\n\n</xml>\n'),('lb_follow_add','SQL','INSERT INTO lb_follow (\n	follow_info,\n	follow_type,\n	follow_name,\n	other_id	\n)\nVALUES\n(\n	${follow_info<STRING>},\n	${follow_type<STRING>},\n	${session.get(\'user_name\')<STRING>},\n	${other_id<INT>}\n)\n'),('lb_follow_total','DSQL','select count(1) total \nfrom lb_follow \nwhere follow_type=${v.set(\"follow_type\",\"STRING\")} and other_id=${v.set(\"other_id\",\"INT\")}\n\n'),('lb_gather','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nselect\n	g.gather_id,\n	g.gather_name,\n	g.gather_co,\n	getTel(${session.get(\'user_opt\')<INT>},${session.get(\'user_id\')<INT>},g.user_id,g.gather_tel) as gather_tel,\n	g.gather_area,\n	g.gather_card,\n	g.gather_address,\n	\n	g.gather_type,\n	g.gather_level,\n	g.gather_weixin,\n	g.gather_weixin_jion,\n	g.gather_status\nfrom v_lb_gather g\nwhere g.gather_id = ${gather_id<INT>}\n\n]]>\n</bean>\n\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../lb/model_form_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n/*\n#set($col={});\n$col.put(\"姓名\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_name\",\"VAL\":\"map.gather_name\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n$col.put(\"单位\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_co\",\"VAL\":\"map.gather_co\"});\n$col.put(\"手机\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_tel\",\"VAL\":\"map.gather_tel\",\"OTHER\":{\"p_verify\":\"ctel\"}});\n$col.put(\"所属区域\",{\"TYPE\":\"AREA\", \"KEY\":\"gather_area\",\"VAL\":\"map.gather_area\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n$col.put(\"详细地址\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_address\",\"VAL\":\"map.gather_address\",\"OTHER\":{\"p_verify\":\"noNull\"}});\n\n$col.put(\"名片\",{\"TYPE\":\"UPLOAD\", \"KEY\":\"gather_card\",\"VAL\":\"map.gather_card\",\"OTHER\":{\"p_verify\":\"noNull\",\"MSG\":\"请上传名片\"}});\n$col.put(\"微信\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_weixin\",\"VAL\":\"map.gather_weixin\"});\n$col.put(\"微信关注\",{\"TYPE\":\"RADIO\",\"KEY\":\"gather_weixin_jion\",\"VAL\":\"map.gather_weixin_jion\",\"LIST\":[{\"K\":\"N\",\"V\":\"未关注\",\"C\":\"checked\"},{\"K\":\"Y\",\"V\":\"已关注\"}]});\n$col.put(\"性质\",{\"TYPE\":\"RADIO\",\"KEY\":\"gather_type\",\"VAL\":\"map.gather_type\",\"OTHER\":{\"p_verify\":\"noNull\",\"MSG\":\"填写性质信息\"},\"LIST\":[{\"K\":\"物业\",\"V\":\"物业\"},{\"K\":\"中介\",\"V\":\"中介\"},{\"K\":\"售楼\",\"V\":\"售楼\"},{\"K\":\"招商\",\"V\":\"招商\"},{\"K\":\"其他\",\"V\":\"其他\",\"C\":\"checked\"}]});\n\n$col.put(\"等级\",{\"TYPE\":\"RADIO\",\"KEY\":\"gather_level\",\"VAL\":\"map.gather_level\",\"OTHER\":{\"p_verify\":\"noNull\",\"MSG\":\"填写等级信息\"},\"LIST\":[{\"K\":\"星星\",\"V\":\"星星\",\"C\":\"checked\"},{\"K\":\"月亮\",\"V\":\"月亮\"},{\"K\":\"太阳\",\"V\":\"太阳\"}]});\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"信息员管理\"); \n\n#set($follow={});\n$follow.put(\"ID\",\"map.follow_id\");\n$follow.put(\"时间\",\"map.follow_create_date\");\n$follow.put(\"跟进人\",\"map.follow_name\");\n$follow.put(\"信息\",\"map.follow_info\");\n$Req.setAttribute(\"FOLLOW\",$follow);\n*/\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\np_verify[\"ctel\"]=function(o){\n	var v = p_verify.val(o);\n	if(v.length!=11 || p_verify[\"number\"](o)){\n		o.attr(\"v_check\",\"请填写手机号码\");\n	}else{\n		\n		o.attr(\"v_check\",\"手机号码有重复\");\n		p_verify.get(\"pa/lb_tel_only.s\",{tel:o.val()},function(data){\n			if(data.length==0){\n				\n				o.attr(\"v_check\",\"Y\");\n			}\n		},\"json\");\n	}\n};\n$(\"#followbtn\").off(\"click\");\n$(\"#followbtn\").click(function(){\n	var param = {};\n	param[\"follow_info\"] = $(\"#follow_info\").val(); \n	param[\"follow_name\"] = my_user_name;\n	$.extend(param,req[\"param\"]);\n	if(param[\"follow_info\"]==\"\"){\n		layer.msg(\"填写跟进信息\");\n		return;\n	}\n	var $that = $(this);\n	$that.attr(\"disabled\", true); \n	setTimeout(function(){\n		$that.removeAttr(\"disabled\");\n	},1000);\n	$.post(\"pa/lb_follow_add.u\",param,function(){\n		$that.removeAttr(\"disabled\");\n		$(\"#follow_info\").val(\"\");\n		callBack(req);\n		top.frames[\'main\'].init();\n	});\n});\n]]>\n</bean>\n\n<bean name=\"CAPTION\">\n<![CDATA[\n<form class=\"layui-form\" onsubmit=\"return false;\" action=\"\">\n  <div class=\"layui-form-item layui-form-text\">\n      <textarea name=\"desc\" placeholder=\"请输入内容\" id=\"follow_info\" class=\"layui-textarea\"></textarea>\n  </div>\n  <div class=\"layui-form-item layui-form-text\">\n		<button class=\"layui-btn\" id=\"followbtn\" lay-submit lay-filter=\"formDemo\">立即提交</button>\n  </div>\n</form>\n]]>\n</bean>\n\n</xml>\n'),('lb_gathers','XML','<xml>\n<bean name=\"DSQL\">\n<![CDATA[\nSELECT\n	g.gather_id,\n	g.gather_name,\n	g.gather_co,\n	getTel(${v.set(\"session.get(\'user_opt\')\",\"INT\")},${v.set(\"session.get(\'user_id\')\",\"INT\")},u.user_id,g.gather_tel) as gather_tel,\n	g.gather_level,\n	g.gather_type,\n	g.gather_weixin,\n	g.gather_weixin_jion,\n	DATE_FORMAT(g.gather_create_date,\'%Y-%m-%d %H时\') gather_create_date,\n	u.user_name,\n	u.user_id,\n	(select max(f.follow_create_date) from lb_follow f where f.other_id = g.gather_id and f.follow_type=\'gather\') follow_max,\n	datediff(NOW(),(select max(f.follow_create_date) from lb_follow f where f.other_id = g.gather_id and f.follow_type=\'gather\')) follow_day,\n	(select count(1) from lb_follow f where f.other_id = g.gather_id and f.follow_type=\'gather\') follow_num,\n	(select count(1) from v_lb_cust_info c where c.gather_id = g.gather_id) cust_num,\n	(select count(1) from v_lb_cust_info c where c.gather_id = g.gather_id and c.cust_status in(\'MEASURE\',\'SIGN\')) measure_num,\n	(select count(1) from v_lb_cust_info c where c.gather_id = g.gather_id and c.cust_measure=\'Y\' and c.cust_status in(\'MEASURE\',\'SIGN\')) measure_pay_num,\n	(select count(1) from v_lb_cust_info c where c.gather_id = g.gather_id and c.cust_measure=\'Y\' and c.cust_status in(\'SIGN\')) \n	sign_num\n\nFROM\n	v_lb_gather g,\n	lb_user u\nWHERE\n	u.user_id = g.user_id\n and (u.user_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")}))\n \n \n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.isEmpty(\"gather_name\"))\n and g.gather_name like  CONCAT(\'%\', ${v.set(\"gather_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"gather_tel\"))\n and g.gather_tel like  CONCAT(\'%\', ${v.set(\"gather_tel\",\"STRING\")},\'%\')\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n\nORDER BY follow_max asc,gather_id desc\n#if (! $v.isEmpty(\"_page\"))\nlimit ${v.set(\"_page\",\"INT\")},${v.set(\"_offset\",\"INT\")}\n#end\n]]>\n</bean>\n<bean name=\"my_user\">\n<![CDATA[\nselect user_id K,user_name V from lb_user u\nwhere u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>} )\n]]></bean>\n<bean name=\"gathers\">\n<![CDATA[\nselect gather_id as K,gather_name AS V from v_lb_gather where user_id = ${session.get(\'user_id\')<INT>}\n]]></bean>\n<bean name=\"TOTAL\" value=\"pa/lb_gathers_total.s\" />\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"SIGN\" value=\"TRUE\"/>\n\n\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n\n\n#*\n#set($colgroup=[150,150,200]);\n$Req.setAttribute(\"colgroup\",$colgroup);\n*#\n$col.put(\"编号\",\"map.gather_id\");\n$col.put(\"姓名\",\"gatherName:map\");\n$col.put(\"单位\",\"map.gather_co\");\n$col.put(\"手机\",\"map.gather_tel\");\n$col.put(\"微信\",\"wx:map\");\n$col.put(\"性质\",\"map.gather_type\");\n$col.put(\"隶属人\",\"map.user_name\");\n$col.put(\"等级\",\"map.gather_level\");\n$col.put(\"创建时间\",\"map.gather_create_date\");\n$col.put(\"回访次数\",\"follow:map\"); \n$col.put(\"未回访天数\",\"map.follow_day\");\n$col.put(\"客户量\",\"cust_num:map\");\n$col.put(\"量房数\",\"measure_num:map\");\n$col.put(\"信息费\",\"measure_pay_num:map\");\n$col.put(\"信息提成\",\"sign_num:map\");\n$col.put(\"操作\",\"opt:map\");\n\n#set($search={}); \n$search.put(\"编号\",{\"TYPE\":\"TEXT\",\"KEY\":\"gather_id\",\"OTHER\":{\"onkeyup\":\"this.value=this.value.replace(/\\D/g,\'\')\", \"onafterpaste\":\"this.value=this.value.replace(/\\D/g,\'\')\"}});\n$search.put(\"姓名\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_name\"});\n$search.put(\"手机\",{\"TYPE\":\"TEXT\", \"KEY\":\"gather_tel\"});\n$search.put(\"隶属人\",{\"TYPE\":\"SELECT\",\"KEY\":\"user_id\",\"SQL\":\"my_user\",\"ISNULL\":\"ALL\"});\n$Req.setAttribute(\"SEARCH\",$search);\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"信息员管理\"); \n$Req.setAttribute(\"DATAURL\",\"pa/lb_gathers.s\");\n$btn.put(\"新增\",\"add({\'win\':\'pa/lb_gather.v\',\'add\':\'pa/lb_gather_add.u\'})\");\n$Req.setAttribute(\"BUTTON\",$btn);\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n\ncmd.data(\"measure_num\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.attr(\"href\",\"pa/lb_cust_infos.v?gather_id=\"+v.gather_id+\"&cust_status=MEASURE\");\n	a.html(v.measure_num);\n	o.append(a);\n});\ncmd.data(\"measure_pay_num\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.attr(\"href\",\"pa/lb_cust_infos.v?gather_id=\"+v.gather_id+\"&cust_status=MEASURE_PAY_NUM\");\n	a.html(v.measure_pay_num);\n	o.append(a);\n});\n\ncmd.data(\"sign_num\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.attr(\"href\",\"pa/lb_cust_infos.v?gather_id=\"+v.gather_id+\"&cust_status=SIGN_NUM\");\n	a.html(v.sign_num);\n	o.append(a);\n});\n\n\ncmd.data(\"cust_num\",function(o,v){\n	\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.attr(\"href\",\"pa/lb_cust_infos.v?gather_id=\"+v.gather_id);\n	a.html(v.cust_num);\n	o.append(a);\n});\ncmd.data(\"wx\",function(o,v){\n	o.html(\"\");\n	var span = $(\"<span></span>\");\n	span.html(v.gather_weixin);\n	if(v.gather_weixin_jion==\"N\" && v.gather_weixin){\n		span.html(v.gather_weixin+\"(未关注)\");\n	}\n	o.append(span);\n});\ncmd.data(\"gatherName\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.html(v.gather_name);\n	a.click(function(){\n		var req = {};\n		req[\"param\"] = {gather_id:v.gather_id,other_id:v.gather_id,follow_type:\"gather\"};\n		req[\"win\"]=\"pa/lb_gather.v\";\n		req[\"info\"]=\"pa/lb_gather.s\";\n		req[\"follow\"]=\"pa/lb_follow.s\";\n		\n		info(req);\n\n	});\n	o.append(a);\n});\ncmd.data(\"follow\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.html(v.follow_num+\"次 \");\n	\n	if(v.user_id == my_user_id){\n		a.click(function(){\n			var req = {};\n			req[\"param\"] = {other_id:v.gather_id,follow_type:\"gather\"};\n			req[\"win\"]=\"pa/lb_follow.v\";\n			req[\"info\"]=\"pa/lb_follow.s\";\n			win(req);\n		});\n		\n	}else{\n		a.click(function(){\n			msg(\"无权操作\");\n		});\n	}\n	o.append(a);\n	if(v.follow_day>10){\n		a.attr(\"style\",\"color:red\");\n	}\n});\ncmd.data(\"opt\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[添加客户]</span>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {gather_id:v.gather_id};\n		req[\"win\"]=\"pa/lb_cust_info_upt.v\";\n		req[\"add\"]=\"pa/lb_cust_info_add.u\";\n		\n		add(req);\n	});\n	\n\n	var $del = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[删除]</span>\')\n	$del.click(function(){\n		layer.confirm(\'是否要删除？\', {\n		  btn: [\'确认\',\'取消\'] \n		}, function(){\n		   $.get(\"pa/lb_gather_del.u\",{gather_id:v.gather_id},function(){\n			   init();\n			   layer.closeAll();\n		   });\n		}, function(){\n		   layer.closeAll();\n		});\n	});\n	\n	if(v.user_id == my_user_id){\n		o.append($del);\n		o.append(span);\n	}\n});\n]]>\n</bean>\n</xml>\n'),('lb_gathers_total','DSQL','select count(1) total from v_lb_gather g,\n	lb_user u\nWHERE\n	u.user_id = g.user_id\n and (u.user_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")}))\n \n \n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.isEmpty(\"gather_name\"))\n and g.gather_name like  CONCAT(\'%\', ${v.set(\"gather_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"gather_tel\"))\n and g.gather_tel like  CONCAT(\'%\', ${v.set(\"gather_tel\",\"STRING\")},\'%\')\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n \n'),('lb_gather_add','SQL','INSERT INTO lb_gather (\n	gather_name,\n	gather_co,\n	gather_tel,\n	gather_type,\n	gather_level,\n	gather_weixin,\n	gather_weixin_jion,\n	gather_area,\n	gather_address,\n	gather_card,\n	\n	user_id\n)\nVALUES\n	(\n	${gather_name<STRING>},\n	${gather_co<STRING>},\n	${gather_tel<STRING>},\n	${gather_type<STRING>},\n	${gather_level<STRING>},\n	${gather_weixin<STRING>},\n	${gather_weixin_jion<STRING>},\n	${gather_area<STRING>},\n	${gather_address<STRING>},\n	${gather_card<STRING>},\n	\n	${session.get(\'user_id\')<INT>}\n)\n'),('lb_gather_del','SQL','update lb_gather set gather_status=\'N\' WHERE gather_id=${gather_id<INT>} and user_id = ${session.get(\'user_id\')<INT>}\n'),('lb_menu','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nSELECT y.* \nFROM lb_menu_tree y\nwhere menu_status = \'Y\'\n ORDER BY PID\n]]>\n</bean>\n<bean name=\"FILTER\" value=\"YES\"/>\n<bean name=\"VIEW\" value=\"$sourceMap.get(\'lb_menu\')\"/>\n<bean name=\"BEAN\" value=\"ManagerMenu\"/>\n</xml>\n'),('lb_my_cust_infos','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nSELECT\n	c.*, dg.dg_status\nFROM\n	v_lb_cust_info c,\n	lb_dg_cust dg\nWHERE\n	c.cust_id = dg.cust_id\nAND dg.user_id = ${session.get(\'user_id\')<INT>}\n]]>\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n<bean name=\"VIEWNAME\" value=\"我的客户\"/>\n<bean name=\"DATAURL\" value=\"pa/lb_my_cust_infos.s\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n#set($colgroup=[50]);\n$col.put(\"ID\",\"map.cust_id\"); \n$col.put(\"姓名\",\"map.cust_name\");\n$col.put(\"电话\",\"map.cust_tel\"); \n\n$Req.setAttribute(\"colgroup\",$colgroup);\n$Req.setAttribute(\"COL\",$col);\n$btn.put(\"新增\",\"add({\'win\':\'pa/lb_cust_info_upt.v\',\'add\':\'pa/lb_cust_info_add.u\'})\");\n$Req.setAttribute(\"BUTTON\",$btn);\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\nvar my_user_id = $(\"#my_user_id\", top.document);\nvar my_user_acc = $(\"#my_user_acc\", top.document);\n\n \ncmd.data(\"opt\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[详情]</span>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {cust_id:v.cust_id};\n		req[\"win\"]=\"pa/lb_cust_info.v\";\n		req[\"info\"]=\"pa/lb_cust_info.s\";\n		\n		info(req);\n	});\n	o.append(span);\n	\n	\n	var del = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[删除]</span>\')\n	del.click(function(){\n		layer.confirm(\'是否要删除？\', {\n		  btn: [\'确认\',\'取消\'] \n		}, function(){\n		   $.get(\"pa/lb_cust_info_del.u\",{cust_id:v.cust_id},function(){\n			   init();\n			   layer.closeAll();\n		   });\n		}, function(){\n		   layer.closeAll();\n		});\n	\n	});\n	if(v.user_id == my_user_id.val()){\n		o.append(del);\n	}\n	\n	//跟进\n	var cust_status = v.cust_status;\n	\n	if(cust_status==\"FOLLOW\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[量房]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要量房？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_measure.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id.val()){\n			o.append($status);\n		}\n	};\n	if(cust_status==\"MEASURE\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[签单]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要签单？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_sign.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id.val()){\n			o.append($status);\n		}\n	};\n	if((cust_status==\"MEASURE\" || cust_status==\"SIGN\") && v.cust_measure ==\"N\"){\n		var $pay = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[信息费]</span>\');\n		$pay.click(function(){\n			layer.confirm(\'是否支付信息费？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_pay.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id.val()){\n			o.append($pay);\n		}\n	};\n	 \n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_my_cust_measure','XML','<xml>\n<bean name=\"DSQL\">\n<![CDATA[\nSELECT\n	c.cust_id,\n	u.user_id,\n	c.cust_name,\n	c.cust_tel,\n	CASE\nWHEN c.cust_measure = \'N\' THEN\n	\'未支付\'\nWHEN c.cust_measure = \'Y\' THEN\n	\'支付\'\nELSE\n	\'未知\'\nEND AS cust_measure_pay,\n CASE\nWHEN c.cust_status = \'FOLLOW\' THEN\n	\'跟进\'\nWHEN c.cust_status = \'SIGN\' THEN\n	\'签单\'\nWHEN c.cust_status = \'MEASURE\' THEN\n	\'量房\'\nWHEN c.cust_status = \'DELETE\' THEN\n	\'删除\'\nELSE\n	\'未知\'\nEND AS cust_status_e,\n c.cust_measure,\n g.gather_name,\n c.cust_status,\n DATE_FORMAT(c.cust_create_date,\'%Y-%m-%d\') cust_create_date,\n u.user_name,\n (\n	SELECT\n		count(1)\n	FROM\n		lb_follow f\n	WHERE\n		f.other_id = c.cust_id\n	AND f.follow_type = \'cust\'\n) follow_num,\n datediff(\n	NOW(),\n	(\n		SELECT\n			max(f.follow_create_date)\n		FROM\n			lb_follow f\n		WHERE\n			f.other_id = c.cust_id\n		AND f.follow_type = \'cust\'\n	)\n) follow_day\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND C.cust_status in (\'MEASURE\',\'SIGN\')\nAND	(u.user_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${v.set(\"session.get(\'user_id\')\",\"INT\")}))\nAND u.user_id = g.user_id\n\n#if (! $v.isEmpty(\"cust_name\"))\n and c.cust_name like  CONCAT(\'%\', ${v.set(\"cust_name\",\"STRING\")},\'%\')\n#end\n#if (! $v.isEmpty(\"cust_tel\"))\n and c.cust_tel like  CONCAT(\'%\', ${v.set(\"cust_tel\",\"STRING\")},\'%\')\n#end\n\n#if (! $v.equals(\"gather_id\",\"ALL\") && ! $v.isEmpty(\"gather_id\"))\n and g.gather_id = ${v.set(\"gather_id\",\"INT\")}\n#end\n#if (! $v.equals(\"user_id\",\"ALL\") && ! $v.isEmpty(\"user_id\"))\n and u.user_id = ${v.set(\"user_id\",\"INT\")}\n#end\n#if (! $v.equals(\"cust_id\",\"ALL\") && ! $v.isEmpty(\"cust_id\"))\n and c.cust_id = ${v.set(\"cust_id\",\"INT\")}\n#end\n\nORDER BY\n	follow_day asc,cust_id desc\n\n]]>\n\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n<bean name=\"my_user\">\n<![CDATA[\nselect user_id K,user_name V from lb_user u\nwhere u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>} )\n]]></bean>\n \n<bean name=\"gathers\">\n<![CDATA[\nselect gather_id as K,gather_name AS V from v_lb_gather where user_id = ${session.get(\'user_id\')<INT>}\n]]></bean>\n<bean name=\"my_cust\">\n<![CDATA[\nselect c.cust_id K,c.cust_name V\nFROM\n	v_lb_cust_info c,\n	v_lb_gather g,\n	lb_user u\nWHERE\n	g.gather_id = c.gather_id\nAND	(u.user_id = ${session.get(\'user_id\')<INT>} or u.user_id in(select s.user_s_id from lb_user_acc_sm s where s.user_m_id = ${session.get(\'user_id\')<INT>}))\nAND u.user_id = g.user_id\n]]></bean>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n\n#set($col={});\n#set($btn={});\n#set($colgroup=[50]);\n$col.put(\"ID\",\"map.cust_id\");\n$col.put(\"隶属人\",\"map.user_name\");\n$col.put(\"信息员\",\"map.gather_name\");\n$col.put(\"客户名称\",\"cust_name:map\");\n$col.put(\"电话\",\"map.cust_tel\");\n$col.put(\"创建时间\",\"map.cust_create_date\");\n\n$col.put(\"信息费\",\"map.cust_measure_pay\");\n$col.put(\"状态\",\"map.cust_status_e\");\n$col.put(\"回访次数\",\"follow:map\");\n$col.put(\"未回访天数\",\"map.follow_day\");\n$col.put(\"操作\",\"opt:map\");\n\n$Req.setAttribute(\"colgroup\",$colgroup);\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"量房客户\"); \n$Req.setAttribute(\"DATAURL\",\"pa/lb_my_cust_measure.s\");\n$btn.put(\"新增\",\"add({\'win\':\'pa/lb_cust_info_upt.v\',\'add\':\'pa/lb_cust_info_add.u\'})\");\n$Req.setAttribute(\"BUTTON\",$btn);\n\n#set($search={}); \n$search.put(\"编码\",{\"TYPE\":\"TEXT\",\"KEY\":\"cust_id\",\"OTHER\":{\"onkeyup\":\"this.value=this.value.replace(/\\D/g,\'\')\", \"onafterpaste\":\"this.value=this.value.replace(/\\D/g,\'\')\"}});\n$search.put(\"姓名\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_name\"});\n$search.put(\"手机\",{\"TYPE\":\"TEXT\", \"KEY\":\"cust_tel\"});\n$search.put(\"信息员\",{\"TYPE\":\"SELECT\",\"KEY\":\"gather_id\",\"SQL\":\"gathers\",\"ISNULL\":\"ALL\"});\n$search.put(\"隶属人\",{\"TYPE\":\"SELECT\",\"KEY\":\"user_id\",\"SQL\":\"my_user\",\"ISNULL\":\"ALL\"});\n$Req.setAttribute(\"SEARCH\",$search);\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\n\n\ncmd.data(\"follow\",function(o,v){\n	o.html(\"\");\n	var a = $(\"<a href=\'javascript:\'></a>\");\n	a.html(v.follow_num+\"次\");\n	a.click(function(){\n		var req = {};\n		req[\"param\"] = {other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_follow.v\";\n		req[\"info\"]=\"pa/lb_follow.s\";\n		\n		win(req);\n	});\n	o.append(a);\n	if(v.follow_day>10){\n		a.attr(\"style\",\"color:red\");\n	}\n});\ncmd.data(\"cust_name\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<a href=\"javascript:\">\'+v.cust_name+\'</a>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {cust_id:v.cust_id,other_id:v.cust_id,follow_type:\"cust\"};\n		req[\"win\"]=\"pa/lb_cust_info.v\";\n		req[\"info\"]=\"pa/lb_cust_info.s\";\n		req[\"follow\"]=\"pa/lb_follow.s\";\n		info(req);\n	});\n	o.append(span);\n});\ncmd.data(\"opt\",function(o,v){\n	\n	\n	\n	var del = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[删除]</span>\')\n	del.click(function(){\n		layer.confirm(\'是否要删除？\', {\n		  btn: [\'确认\',\'取消\'] \n		}, function(){\n		   $.get(\"pa/lb_cust_info_del.u\",{cust_id:v.cust_id},function(){\n			   init();\n			   layer.closeAll();\n		   });\n		}, function(){\n		   layer.closeAll();\n		});\n	\n	});\n	if(v.user_id == my_user_id){\n		o.append(del);\n	}\n	\n	//跟进\n	var cust_status = v.cust_status;\n	\n	if(cust_status==\"FOLLOW\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[量房]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要量房？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_measure.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($status);\n		}\n	};\n	if(cust_status==\"MEASURE\"){\n		var $status = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[签单]</span>\');\n		$status.click(function(){\n			layer.confirm(\'是否要签单？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_sign.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($status);\n		}\n	};\n	if((cust_status==\"MEASURE\" || cust_status==\"SIGN\") && v.cust_measure ==\"N\"){\n		var $pay = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[信息费]</span>\');\n		$pay.click(function(){\n			layer.confirm(\'是否支付信息费？\', {\n			  btn: [\'确认\',\'取消\'] \n			}, function(){\n			   $.get(\"pa/lb_cust_info_pay.u\",{cust_id:v.cust_id},function(){\n				   init();\n				   layer.closeAll();\n			   });\n			}, function(){\n			   layer.closeAll();\n			});\n		});\n		if(v.user_id == my_user_id){\n			o.append($pay);\n		}\n	};\n	 \n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_tel_only','SQL','SELECT 1 AS TEL FROM v_lb_cust_info c where c.cust_tel = ${tel<STRING>}\nUNION ALL\nSELECT 1 FROM v_lb_gather G WHERE G.gather_tel =  ${tel<STRING>}\n'),('lb_user','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nselect * from lb_user\n]]>\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_list_templete.jsp\"/>\n\n<bean name=\"MAPPING\">\n<![CDATA[\n#set($col={});\n#set($btn={});\n$col.put(\"名称\",\"map.user_name\");\n$col.put(\"联系电话\",\"map.user_tel\");\n$col.put(\"账号\",\"map.user_acc\");\n$col.put(\"操作\",\"opt:map\");\n$Req.setAttribute(\"COL\",$col);\n\n$btn.put(\"新增\",\"add({\'win\':\'pa/lb_user_info.v\',\'add\':\'pa/lb_user_add.u\'})\");\n$Req.setAttribute(\"BUTTON\",$btn)\n$Req.setAttribute(\"DATAURL\",\"pa/lb_user.s\");\n$Req.setAttribute(\"VIEWNAME\",\"员工管理\");\n$Req.setAttribute(\"SCRIPT\",\"lb/index.js\");\n\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\ncmd.data(\"opt\",function(o,v){\n	o.html(\"\");\n	var span = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[赋权]</span>\')\n	span.click(function(){\n		var req = {};\n		req[\"param\"] = {user_id:v.user_id};\n		req[\"win\"]=\"pa/lb_user_auth.v\";\n		req[\"info\"]=\"pa/lb_user_auth.s\";\n	\n		win(req);\n	});\n	o.append(span);\n	\n	var update = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[修改]</span>\')\n	update.click(function(){\n		var req = {};\n		req[\"param\"] = {id:v.user_id};\n		req[\"win\"]=\"pa/lb_user_info.v\";\n		req[\"info\"]=\"pa/lb_user_info.s\";\n		req[\"upt\"] =\"pa/lb_user_upt.u\";\n		upt(req);\n	\n	});\n	o.append(update);\n	\n	var html = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[删除]</span>\')\n	html.click(function(){\n		layer.confirm(\'是否要删除？\', {\n		  btn: [\'确认\',\'取消\']\n		}, function(){\n		   $.get(\"pa/lb_user_del.u\",{id:v.user_id},function(){\n			   init();\n			   layer.closeAll();\n		   });\n		}, function(){\n		   layer.closeAll();\n		});\n	\n	});\n	o.append(html);\n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_user_add','SQL','insert into lb_user\n(user_name,user_tel,user_acc,user_pwd,user_opt)\nvalues \n(${user_name<STRING>},${user_tel<STRING>},${user_acc<STRING>},${user_pwd<STRING>},${user_opt<STRING>})\n'),('lb_user_auth','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nSELECT u.*,us.user_m_id FROM (select * from lb_user where user_id != ${user_id<INT>}) u LEFT JOIN \n(select user_m_id,user_s_id from lb_user_acc_sm where user_m_id = ${user_id<INT>}) us \non u.user_id = us.user_s_id\n]]>\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/win_list_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n#set($col={});\n$col.put(\"名称\",\"map.user_name\");\n$col.put(\"联系电话\",\"map.user_tel\");\n$col.put(\"账号\",\"map.user_acc\");\n$col.put(\"操作\",\"opt:map\");\n$Req.setAttribute(\"COL\",$col);\n]]>\n</bean>\n<bean name=\"CALLBACK\">\n<![CDATA[\ncmd.data(\"opt\",function(o,v){\n	if(v.user_m_id){\n		o.html(\"\");\n		var span = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[取消]</span>\');\n		span.click(function(){\n			\n			$.get(\"pa/lb_user_auth_del.u\",{user_s_id:v.user_id,user_id:req.param.user_id},function(){\n			   callBack(req);\n		   });\n		});\n		o.append(span);\n	}else{\n		o.html(\"\");\n		var span = $(\'<span class=\"operate\" style=\"cursor:pointer;\">[赋权]</span>\');\n		span.click(function(){\n			\n			$.get(\"pa/lb_user_auth_add.u\",{user_s_id:v.user_id,user_id:req.param.user_id},function(){\n			   callBack(req);\n		   });\n		});\n		o.append(span);\n	}\n	\n});\n]]>\n</bean>\n</xml>\n'),('lb_user_auth_add','SQL','insert into lb_user_acc_sm(user_m_id,user_s_id)values(${user_id<INT>},${user_s_id<INT>})\n'),('lb_user_auth_del','SQL','delete from lb_user_acc_sm where user_m_id = ${user_id<INT>} and user_s_id = ${user_s_id<INT>}\n'),('lb_user_del','SQL','delete from lb_user where user_id = ${id<INT>}\n'),('lb_user_info','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nselect * from lb_user where user_id = ${id<INT>}\n]]>\n</bean>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_form_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n/*\n#set($col={});\n#set($btn={});\n$col.put(\"名称\",{\"TYPE\":\"TEXT\", \"KEY\":\"user_name\",\"VAL\":\"map.user_name\"});\n$col.put(\"联系电话\",{\"TYPE\":\"TEXT\", \"KEY\":\"user_tel\",\"VAL\":\"map.user_tel\"});\n$col.put(\"账号\",{\"TYPE\":\"TEXT\", \"KEY\":\"user_acc\",\"VAL\":\"map.user_acc\"});\n\n$col.put(\"角色\",{\"TYPE\":\"RADIO\", \"KEY\":\"user_opt\",\"VAL\":\"map.user_opt\",\"LIST\":[{\"K\":\"2\",\"V\":\"员工\",\"C\":\" checked \"},{\"K\":\"3\",\"V\":\"设计师\"}\n,{\"K\":\"9\",\"V\":\"设计主管\"},{\"K\":\"1\",\"V\":\"系统管理员\"}\n\n]});\n\n$col.put(\"密码\",{\"TYPE\":\"TEXT\", \"KEY\":\"user_pwd\",\"VAL\":\"map.user_pwd\"});\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"用户管理\"); \n*/\n\n]]>\n</bean>\n</xml>\n'),('lb_user_login','XML','<xml>\n<bean name=\"SQL\">\n<![CDATA[\nselect user_id,user_acc,user_name,user_opt from lb_user where user_acc = ${user_acc<STRING>} and user_pwd = ${user_pwd<STRING>}\n]]>\n</bean>\n<bean name=\"FILTER\" value=\"YES\"/>\n<bean name=\"DEBUGGER\" value=\"TRUE\"/>\n<bean name=\"BEAN\" value=\"ModelList\"/>\n<bean name=\"TEMPLATE\" value=\"../page/model_form_templete.jsp\"/>\n<bean name=\"MAPPING\">\n<![CDATA[\n#set($col={});\n$col.put(\"账号\",{\"TYPE\":\"TEXT\", \"KEY\":\"user_acc\"});\n$col.put(\"密码\",{\"TYPE\":\"PASSWORD\", \"KEY\":\"user_pwd\"});\n\n$Req.setAttribute(\"COL\",$col);\n$Req.setAttribute(\"VIEWNAME\",\"登录\");\n]]>\n</bean>\n<bean name=\"VIEW\">\n#if (!$this.isEmpty())\n	$session.setAttribute(\"user_id\",$this[0].user_id)\n	$session.setAttribute(\"user_acc\",$this[0].user_acc)\n	$session.setAttribute(\"user_name\",$this[0].user_name)\n	$session.setAttribute(\"user_opt\",$this[0].user_opt)\n	\n#end\n$v.toJson()\n</bean>\n</xml>\n'),('lb_user_logout','XML','<xml>\n\n<bean name=\"FILTER\" value=\"YES\"/>\n\n<bean name=\"VIEW\">\n$session.removeAttribute(\"user_id\")\n$session.removeAttribute(\"user_acc\")\n$session.removeAttribute(\"user_name\")\n$session.removeAttribute(\"user_opt\")\n\n{\"status\":\"Y\"}\n</bean>\n</xml>\n'),('lb_user_upt','SQL','update lb_user\n set user_name=${user_name<STRING>},\n     user_tel=${user_tel<STRING>},\n	 user_acc=${user_acc<STRING>},\n	 user_opt=${user_opt<STRING>},\n	 user_pwd=${user_pwd<STRING>}\nwhere user_id = ${id<INT>}\n');
/*!40000 ALTER TABLE `sm_bean` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Temporary view structure for view `v_lb_cust_info`
--

DROP TABLE IF EXISTS `v_lb_cust_info`;
/*!50001 DROP VIEW IF EXISTS `v_lb_cust_info`*/;
SET @saved_cs_client     = @@character_set_client;
SET character_set_client = utf8;
/*!50001 CREATE VIEW `v_lb_cust_info` AS SELECT 
 1 AS `cust_id`,
 1 AS `cust_name`,
 1 AS `gather_id`,
 1 AS `cust_tel`,
 1 AS `cust_status`,
 1 AS `cust_version_date`,
 1 AS `cust_measure`,
 1 AS `cust_create_date`,
 1 AS `cust_sex`,
 1 AS `cust_memo`,
 1 AS `cust_class_id`,
 1 AS `cust_class_info`,
 1 AS `cust_area`,
 1 AS `cust_address`,
 1 AS `cust_space`*/;
SET character_set_client = @saved_cs_client;

--
-- Temporary view structure for view `v_lb_gather`
--

DROP TABLE IF EXISTS `v_lb_gather`;
/*!50001 DROP VIEW IF EXISTS `v_lb_gather`*/;
SET @saved_cs_client     = @@character_set_client;
SET character_set_client = utf8;
/*!50001 CREATE VIEW `v_lb_gather` AS SELECT 
 1 AS `gather_id`,
 1 AS `user_id`,
 1 AS `gather_name`,
 1 AS `gather_co`,
 1 AS `gather_tel`,
 1 AS `gather_type`,
 1 AS `gather_level`,
 1 AS `gather_status`,
 1 AS `gather_create_date`,
 1 AS `gather_weixin`,
 1 AS `gather_weixin_jion`,
 1 AS `gather_area`,
 1 AS `gather_card`,
 1 AS `gather_address`*/;
SET character_set_client = @saved_cs_client;

--
-- Final view structure for view `v_lb_cust_info`
--

/*!50001 DROP VIEW IF EXISTS `v_lb_cust_info`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = utf8 */;
/*!50001 SET character_set_results     = utf8 */;
/*!50001 SET collation_connection      = utf8_general_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`localhost` SQL SECURITY DEFINER */
/*!50001 VIEW `v_lb_cust_info` AS select `c`.`cust_id` AS `cust_id`,`c`.`cust_name` AS `cust_name`,`c`.`gather_id` AS `gather_id`,`c`.`cust_tel` AS `cust_tel`,`c`.`cust_status` AS `cust_status`,`c`.`cust_version_date` AS `cust_version_date`,`c`.`cust_measure` AS `cust_measure`,`c`.`cust_create_date` AS `cust_create_date`,`c`.`cust_sex` AS `cust_sex`,`c`.`cust_memo` AS `cust_memo`,`c`.`cust_class_id` AS `cust_class_id`,`c`.`cust_class_info` AS `cust_class_info`,`c`.`cust_area` AS `cust_area`,`c`.`cust_address` AS `cust_address`,`c`.`cust_space` AS `cust_space` from (`lb_cust_info` `c` join `lb_gather` `g`) where ((`c`.`cust_status` <> 'DELETE') and (`g`.`gather_id` = `c`.`gather_id`) and (`g`.`gather_status` <> 'N')) */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;

--
-- Final view structure for view `v_lb_gather`
--

/*!50001 DROP VIEW IF EXISTS `v_lb_gather`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = utf8 */;
/*!50001 SET character_set_results     = utf8 */;
/*!50001 SET collation_connection      = utf8_general_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`localhost` SQL SECURITY DEFINER */
/*!50001 VIEW `v_lb_gather` AS select `lb_gather`.`gather_id` AS `gather_id`,`lb_gather`.`user_id` AS `user_id`,`lb_gather`.`gather_name` AS `gather_name`,`lb_gather`.`gather_co` AS `gather_co`,`lb_gather`.`gather_tel` AS `gather_tel`,`lb_gather`.`gather_type` AS `gather_type`,`lb_gather`.`gather_level` AS `gather_level`,`lb_gather`.`gather_status` AS `gather_status`,`lb_gather`.`gather_create_date` AS `gather_create_date`,`lb_gather`.`gather_weixin` AS `gather_weixin`,`lb_gather`.`gather_weixin_jion` AS `gather_weixin_jion`,`lb_gather`.`gather_area` AS `gather_area`,`lb_gather`.`gather_card` AS `gather_card`,`lb_gather`.`gather_address` AS `gather_address` from `lb_gather` where (`lb_gather`.`gather_status` = 'Y') */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2017-06-09  8:39:06
